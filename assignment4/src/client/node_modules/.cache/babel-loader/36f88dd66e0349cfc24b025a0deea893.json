{"ast":null,"code":"var _jsxFileName = \"/Users/aikam320/Desktop/3309/webInterface/SE3309DBMS/client/src/pages/Login.jsx\";\nimport React, { Fragment, Component } from 'react';\nimport { MainContainer, WelcomeText, InputContainer, Input, ButtonContainer, StyledButton } from '../css/Login';\nimport { Helmet } from 'react-helmet'; // Need to set these for the cookies\n\nimport { instanceOf } from 'prop-types';\nimport { withCookies, Cookies } from 'react-cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Login extends Component {\n  // Add this line of code to add the cookies handler to your class props\n  constructor(props) {\n    super(props); // use axios\n\n    this.isNotEmptyFields = () => {\n      return this.state.email && this.state.password ? true : false;\n    };\n\n    this.login = () => {\n      if (!this.isNotEmptyFields()) return;\n      this.setState(prevState => {\n        return Object.assign({}, prevState, {\n          isAuthenticating: true\n        });\n      }, () => {\n        this.loginProcess();\n      });\n    };\n\n    this.loginProcess = () => {\n      if (this.state.isAuthenticating) {\n        // Assign the credentials to the basic OAuth\n        const username = this.state.email;\n        const password = this.state.password; // Convert to base64\n\n        const token = Buffer.from(`${username}:${password}`, 'utf8').toString('base64');\n        const url = 'http://localhost:3005/authenticate';\n        this.axios.post(url, {}, {\n          headers: {\n            'Authorization': `Basic ${token}`\n          }\n        }).then(response => {\n          // Set the user cookie here\n          this.setState(prevState => {\n            return Object.assign({}, prevState, {\n              isAuthenticating: false\n            });\n          }, () => {\n            if (response.data.id) {\n              this.setUserCookie(response.data.id);\n              window.location.href = '/home';\n            } else {\n              // If there is not id\n              this.setState(prevState => {\n                return Object.assign({}, prevState, {\n                  errorMessage: response.data.message\n                });\n              });\n            }\n          });\n        }).catch(() => {\n          this.setState(prevState => {\n            return Object.assign({}, prevState, {\n              isAuthenticating: false\n            });\n          });\n        });\n      }\n    };\n\n    this.setUserCookie = id => {\n      this.props.cookies.set('userId', id, {\n        path: '/',\n        maxAge: process.env.REACT_APP_ENV_COOKIES_MAX_AGE\n      });\n    };\n\n    this.handleChange = event => {\n      let {\n        name,\n        value\n      } = event.target;\n      this.setState(prevState => {\n        return Object.assign({}, prevState, {\n          [name]: value\n        });\n      });\n    };\n\n    this.axios = require('axios'); // class component state\n\n    this.state = {\n      email: null,\n      password: null,\n      isAuthenticating: false,\n      errorMessage: null\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(MainContainer, {\n      children: [/*#__PURE__*/_jsxDEV(WelcomeText, {\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(InputContainer, {\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          type: \"text\",\n          placeholder: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          type: \"password\",\n          placeholder: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ButtonContainer, {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          content: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nLogin.propTypes = {\n  cookies: instanceOf(Cookies).isRequired\n};\nexport default _c = withCookies(Login);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/aikam320/Desktop/3309/webInterface/SE3309DBMS/client/src/pages/Login.jsx"],"names":["React","Fragment","Component","MainContainer","WelcomeText","InputContainer","Input","ButtonContainer","StyledButton","Helmet","instanceOf","withCookies","Cookies","Login","constructor","props","isNotEmptyFields","state","email","password","login","setState","prevState","Object","assign","isAuthenticating","loginProcess","username","token","Buffer","from","toString","url","axios","post","headers","then","response","data","id","setUserCookie","window","location","href","errorMessage","message","catch","cookies","set","path","maxAge","process","env","REACT_APP_ENV_COOKIES_MAX_AGE","handleChange","event","name","value","target","require","render","propTypes","isRequired"],"mappings":"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","sourcesContent":["import React, { Fragment, Component } from 'react';\n\nimport {MainContainer, WelcomeText, InputContainer, Input, ButtonContainer, StyledButton} from '../css/Login';\nimport { Helmet } from 'react-helmet';\n\n// Need to set these for the cookies\nimport { instanceOf } from 'prop-types';\nimport { withCookies, Cookies } from 'react-cookie';\n\nclass Login extends Component { \n\n    // Add this line of code to add the cookies handler to your class props\n    static propTypes = {\n        cookies: instanceOf(Cookies).isRequired\n    };\n\n    constructor(props) {\n        super(props);\n\n        // use axios\n        this.axios = require('axios');\n\n        // class component state\n        this.state = {\n            email: null,\n            password: null,\n            isAuthenticating: false,\n            errorMessage: null\n        }\n    }\n\n    isNotEmptyFields = () => {\n        return this.state.email && this.state.password ? true : false\n    }\n\n    login = () => {\n        if (!this.isNotEmptyFields()) return;\n\n        this.setState(prevState => {\n            return Object.assign({}, prevState, {\n                isAuthenticating: true,\n            })\n        }, () => {\n            this.loginProcess();            \n        });\n    }\n\n    loginProcess = () => {\n        if (this.state.isAuthenticating) {\n\n            // Assign the credentials to the basic OAuth\n            const username = this.state.email;\n            const password = this.state.password;\n\n            // Convert to base64\n            const token = Buffer.from(`${username}:${password}`, 'utf8').toString('base64');\n            const url = 'http://localhost:3005/authenticate';\n\n            this.axios.post(url, {}, {\n                headers : {\n                    'Authorization': `Basic ${token}`\n                }\n            })\n            .then((response) => {\n\n                // Set the user cookie here\n                this.setState(prevState => {\n                    return Object.assign({}, prevState, {\n                        isAuthenticating: false\n                    });\n                }, () => {\n\n                    if (response.data.id) {\n                        this.setUserCookie(response.data.id);\n                        window.location.href = '/home';\n                    } else { // If there is not id\n                        this.setState(prevState => {\n                            return Object.assign({}, prevState, {\n                                errorMessage: response.data.message\n                            });\n                        });\n                    }\n                });\n\n            })\n            .catch(() => {\n                this.setState(prevState => {\n                    return Object.assign({}, prevState, {\n                        isAuthenticating: false\n                    })\n                });\n            });\n        }\n    }\n\n\n    setUserCookie = (id) => {\n        this.props.cookies.set('userId', id, {\n            path: '/',\n            maxAge: process.env.REACT_APP_ENV_COOKIES_MAX_AGE\n        });\n    }\n\n    // We need this to handle the onChange of our input boxes\n    handleChange = (event) => {\n        let { name, value } = event.target;\n\n        this.setState(prevState => {\n            return Object.assign({}, prevState, {\n                [name] : value\n            });\n        });\n    }\n\n    render() {\n        return (\n            <MainContainer>\n                <WelcomeText>Login</WelcomeText>\n                <InputContainer>\n                    <Input type=\"text\" placeholder=\"Email\" />\n                    <Input type=\"password\" placeholder=\"Password\" />\n                </InputContainer>\n                <ButtonContainer>\n                    <Button content=\"Login\" />\n                </ButtonContainer>\n            </MainContainer>\n\n\n            \n        );\n    }\n}\n\nexport default withCookies(Login);"]},"metadata":{},"sourceType":"module"}